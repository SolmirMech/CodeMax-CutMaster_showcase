# CodeMax-CutMaster
Программа для расчёта параметров резки этикеток по ручьям
и печати ярлыков на втулки и ролики с графическим интерфейсом.

## 📋 О проекте
CodeMax-CutMaster — это многофункциональное приложение для расчётов, включающее:
	- Калькуляторы резки этикеток по диаметру и поштучно
	- Систему печати ярлыков с настройками
	- Сохранение настроек натяжения резательных станков для отдельных заказов
	- Обработку Дата Матрикс кодов и печать ярлыков разными способами
	- Генерацию реестров (номеров) и диапазонов (QR/DM коды) для специфичных заказчиков
	- Возможность добавлять новые шаблоны печати или менять существующие под заказчика

## 🚀 Возможности

### 📊 Основной модуль (Общий калькулятор)
	Модуль obc_app предоставляет комплексный инструментарий для расчёта параметров резки этикеток — 
	от базовых вычислений до печати ярлыков и сохранения настроек оборудования.

## 📁 Структура модуля (apps/obc_app/)
	obc_app/
	├── __init__.py
	├── obc_ui.py                  # Главное окно с вкладками
	├── obc_dia_calculator.py      # Вкладка "Расчёт по диаметру"
	├── obc_piece_calculator.py    # Вкладка "Расчёт поштучно"
	├── obc_printer.py             # Вкладка "Печать этикеток"
	├── obc_printer_dia.py         # Настройки диалогов для вкладки "Печать этикеток"
	└── obc_taper_settings.py      # Вкладка "Настройки натяжения"

## 🧩 Функциональность вкладок
1. Расчёт по диаметру (obc_dia_calculator.py - DiameterCalculator)
    • Интеллектуальный расчёт: Автоматическое вычисление количества съёмов, роликов и метража на станок 
	на основе ограничения метража съёма.
    • Учёт прогресса: Ввод данных о выполненной работе (сделано ранее, фактический метраж, 
	дополнительные этикетки).
    • Динамическая валидация: Проверка корректности введённых параметров с цветовой индикацией.
    • Коэффициент резки: Настраиваемый коэффициент учёта погрешности станка с сохранением в конфигурации.
    • Интеграция с печатью: Автоматическая передача расчётных значений 
	(количество копий, этикеток на ролик) в модуль печати.
    • Экспорт остатков: Функция отправки остатка тиража во вкладку "Расчёт поштучно",
    позволяет пересчитать остаток тиража при изменении количества ручьёв.

2. Расчёт поштучно (obc_piece_calculator.py - PieceCalculator)
    • Точный поштучный учёт: Расчёт на основе максимального количества этикеток в ролике.
    • Разделение на полные и частичные съёмы: Учёт остатков и расчёт параметров для последнего съёма.
    • Гибкие параметры: Настройка множителя ручьёв для сложных схем резки.
    • Синхронизация с печатью: Автоматическое обновление данных для печати ярлыков.
    • Валидация заказа: Сравнение расчётного метража с сопроводительной документацией.

3. Печать этикеток (obc_printer.py - LabelPrinter)
    • Умный номер заказа: Разделённый ввод с префиксом, основным номером и суффиксом.
    • Автоматическое скрытие производителя: Определение необходимости печати 
	"Производитель" по заполненному списку Список клиентов без Производителя.
    • Система поиска заказчиков:

 ## Заказчики без Производителя: 
    • Автоматическое скрытие "Производитель" для клиентов из Списка клиентов без Производителя.

 ## Особые клиенты: 
    • Отображение специальных инструкций для резки из Списка особых клиентов.
	
    • Управление резчиками: Выбор из сохранённого списка с возможностью редактирования.
    • Гибкие настройки печати: Шрифты, отступы, зазор между этикетками с сохранением в профиле obc_labels.
    • Двойные ярлыки: Печать двух идентичных этикеток (по умолчанию в две узкие полоски 17х58 мм.)

4. Настройки натяжения (obc_taper_settings.py - TaperSettings)
    • База параметров оборудования: Хранение настроек намотки/размотки для различных материалов и заказов.
    • Поиск и фильтрация: Быстрый поиск по материалам и комментариям.
    • Редактирование параметров: Интуитивное добавление и изменение настроек с валидацией.
    • Детальные подсказки: Информация о назначении каждого параметра натяжения.
    • Структурированное хранение: Сохранение в JSON-формате с возможностью расширения.

 ## ⚙️ Конфигурация и данные модуля
 ## Управление настройками (core/config_manager.py)
    • Централизованное хранение: Единая точка управления всеми конфигурационными файлами.
    • Автоматическое создание папок: Инициализация необходимых директорий при первом запуске.
    • Резервные значения: Использование значений по умолчанию при отсутствии настроек.

 ## Ключевые конфигурационные файлы:
 
    **• shared_utils.json:
    Списки резчиков, упаковщиков, клиентов с особыми требованиями
	Список заказчиков для печати без Производителя
    Коэффициент резки (waste_coef)
    Пути к базам данных и правилам сокращений

    **• print_settings.json:
    Профили печати для разных модулей (obc_labels, syc_rolls, etc.)
    Параметры шрифтов, отступов и иных настроек по необходимости

    **• taper_settings.json:
    База данных настроек натяжения для различных материалов
    Параметры намотки, размотки, градиентов (если такая настройка есть в станке)
    Технические комментарии и особенности резки

## Общие утилиты (core/shared_utils.py)
	• Конвертация единиц: Функции перевода миллиметров в пиксели для печати.
	• Работа с принтерами: Утилиты для получения принтера по умолчанию и создания контекста печати.
	• Кросс-модульная совместимость: Единые функции для всех модулей приложения.

## 🔄 Интеграция между компонентами
	• Сквозная передача данных: Результаты расчётов автоматически передаются в модуль печати.
	• Единая система настроек: Все модули используют общие конфигурационные файлы через ConfigManager.
	• Синхронизация принтеров: Функция массового обновления принтеров во всех секциях настроек.
	• Внимание: Windows 10 не поддерживает автоматическое обновление сетевых принтеров!
	• Совместное использование данных: Списки резчиков и заказчиков доступны во всех связанных модулях.

## 🖨️ Особенности печати этикеток
	• Адаптивный контент: Динамическое формирование текста в зависимости от типа заказа и заказчика.
	• Цветовая индикация: Визуальное отображение статуса найденных заказчиков.
	• Многокопийность: Поддержка печати нескольких копий этикеток.
	• Профессиональное форматирование: Чёткое позиционирование элементов на ярлыке.

Этот модуль представляет собой законченное решение для задач калькуляции резки этикеток, 
объединяющее в себе точные расчёты, гибкую систему печати и профессиональное управление 
настройками оборудования.

## Дополнительные модули

##🔍 Обработка и анализ Дата Матрикс кодов
	**Модуль dm_app** предоставляет комплексный инструментарий для работы с кодами маркировки 
	(GS1, Data Matrix, QR) — от сканирования и проверки до генерации печатных ярлыков.

## 📁 Структура модуля (apps/dm_app/)
	dm_app/
	├── __init__.py
	├── dm_ui.py              # Главное окно с вкладками
	├── dm_analyzer.py        # Вкладка "Анализатор кодов"
	├── dm_name_editor.py     # Вспомогательное окно редактирования названий
	├── dm_order_parser.py    # Вспомогательное окно обработки файлов
	├── dm_printer.py         # Вкладка "Печать кодов"
	└── dm_processor.py       # Вкладка "Обработка названий"

## 🧩 Функциональность вкладок
1. **Анализатор кодов (dm_analyzer.py)
	• Сканирование GTIN: Извлечение 14-значных GTIN из полных кодов (по префиксу 01).
	• Статистика в реальном времени: Учёт количества уникальных кодов и их повторений.
	• Сравнение с эталоном: Загрузка и проверка последовательности отсканированных кодов 
	против сохранённого эталона.
	• Режим проверки на дубликаты:
	o Честный знак: Поиск полного совпадения кодов.
	o Data Matrix/QR: Поиск совпадающих числовых последовательностей (от 6 цифр).
	• Расчёт расстояния: Определение метража между дубликатами с учётом длины этикетки.

2. **Обработка названий (dm_processor.py)
	• Интеграция с базой данных: Автоматический поиск файлов заказов (Excel, Word, json, csv, txt) 
	по номеру в указанной папке.
	• Умный парсинг: Извлечение наименований товаров и количества ручьёв из структурированных файлов.
	Внимание! Файл Word просто открывается ввиду сложной псевдографики, из-за чего парсинг затруднён.
	После этого наименования нужно добавлять в таблицу обработки вручную через строку ввода,
	либо преобразовать файл в json с помощью нейросети.
	Для парсинга csv в файле обязательно нужен заголовок - первая строка "Наименование;ручьи"
	• Сопоставление с GTIN: Автоматическое связывание данных заказа с отсканированными GTIN 
	(по последним 4-6 цифрам).
	• Интеллектуальное сокращение текста:
	o База замен: Загрузка пользовательских правил сокращений из CSV-файла (Baza_Rezka.csv).
	o Автоматические паттерны: Удаление технической информации (размеры, коды эмитентов), стандартные сокращения 
	("газированная" -> "газ").
	o Визуализация: Подсветка строк, где название превышает лимит символов для печати.
	• Редактирование: Интерактивное редактирование названий прямо в таблице с предпросмотром форматирования.
	• Предпросмотр в реальном времени: Цветовая индикация (зелёный/жёлтый/красный) для визуальной оценки 
	длины текста(количество символов в строке автоматически меняется в зависимости от 9pt или 8pt шрифта)

3. **Печать кодов (dm_printer.py)
	• Гибкие шаблоны: Настройка шрифтов, отступов, зазоров и размеров этикетки.
	• Печать диапазона съёмов: Поддержка печати ярлыков для нескольких съёмов заказа с прямой или обратной 
	нумерацией.
	• Автоматическое форматирование текста: Разбивка длинных названий на две строки с учётом размера шрифта.
	• Интеграция с конфигурацией: Использование общих настроек принтеров и списка резчиков.

## ⚙️ Конфигурация и данные модуля
	• Пути к данным: Выбор путей к базе замен (Baza_Rezka.csv) и к папке с заказами для обработки
	(путь может быть как сетевым, так и локальным).
	• Настройки печати: хранятся в data/print_settings.json для модуля code_labels.
	• Синхронизация: Вкладки модуля тесно связаны — данные плавно передаются от сканирования 
	к обработке и печати. При этом данные можно вводить в таблицу обработки напрямую без парсинга,
	либо вовсе вводить прямо во вкладке печати без обработки, любой способ сработает.

## 🖨️ Особенности печати
	• Двойные ярлыки: на одном листе печатаются две идентичные этикетки (полоски), по умолчанию 17х58мм.
	• Динамический контент: Дата, номер заказа, резчик, номер съёма, название товара.
	• Шрифты: Раздельные настройки для основного текста и названия товара.
	• Позиционирование: Точное размещение элементов (например, смещение номера съёма относительно слова "Съём").
	
Этот модуль представляет собой законченное решение для задач маркировки, объединяющее в себе 
сканер, верификатор, обработчик данных и систему гибкой печати.


##📋 Special Customers - генерация реестров, диапазонов и универсальная печать
	Модуль syc_app предоставляет специализированные инструменты для работы с особыми заказчиками,
	требующими нестандартных форматов этикеток, реестров и спецификаций.

##📁 Структура модуля (apps/syc_app/)
	syc_app/
	├── __init__.py
	├── syc_ui.py                 # Главное окно с вкладками
	├── diapazon_printer.py       # Диапазоны (DiapazonPrinter)
	├── double_label_stickers.py  # Общие стикеры Двойные этикетки (DoubleLabelPrinter)
	├── single_label_stickers.py  # Общие стикеры Одиночные этикетки (SingleLabelPrinter)
	├── syc_label_printer.py      # Шаблон на ролик (LargeLabelPrinter)
	├── syc_register_printer.py   # Реестр на коробку (RegisterPrinter)
	└── technomed_printer.py      # Спецификация (TechnomedPrinter)

##🧩 Функциональность вкладок

**1. Генерация Реестров
Объединяет два взаимосвязанных инструмента для комплексной маркировки:

**Шаблон на ролик (LargeLabelPrinter)
	Крупноформатные этикетки: Печать размером 70×100 мм для маркировки роликов
	Комплексная информация: Количество, дата, резчик, упаковщик, диапазон номеров
	Управление исполнителями:
	Выбор резчиков из общего списка (синхронизируется с Общим калькулятором)
	Редактирование списка упаковщиков прямо из интерфейса
	Автоматическое заполнение: Передача данных из реестра для печати этикеток
	Гибкие настройки печати: Размер шрифта, отступы, межстрочные интервалы

**Реестр на коробку (RegisterPrinter)
	Автоматическая генерация: Расчёт номеров для упаковки на ролики и коробки
	Две стратегии генерации:
	Последовательная: Номера идут подряд по съёмам
	По ручьям: Номера распределяются по параллельным ручьям с заданным шагом
	Визуализация в таблице: Предпросмотр сгенерированных диапазонов с возможностью редактирования
	Пакетная печать: Автоматическая печать всего тиража с контролем прогресса
	Интерактивное редактирование: Двойной клик для изменения значений прямо в таблице
	Интеграция с шаблоном: Автоматическая передача данных для печати этикеток

**2. Генерация диапазонов/Спецификация
Совмещает два специализированных инструмента для работы с числовыми последовательностями:

**Диапазоны (DiapazonPrinter)
	Работа с числовыми последовательностями: Обработка и группировка номеров
	Интеллектуальное сканирование:
	Поочерёдное сканирование первого и последнего номера
	Автоматическое определение принадлежности к диапазонам
	Визуальная индикация статуса (зелёный/красный)
	Автоматическая печать тиража: Расчёт и печать всего тиража диапазонами
	Удобочитаемое форматирование: Автоматическое добавление пробелов (1 000 000)
	Контекстное меню: Быстрая вставка из буфера обмена (Ctrl+V)
	Валидация данных: Проверка корректности числовых значений

**Спецификация (TechnomedPrinter)
	Специализированный формат: Этикетки для специфичных требований заказчика Technomed
	Структурированные поля:
	Номер заказа в трёх частях (префикс-номер-суффикс)
	Спецификация с автоматическим вычислением идентификационного номера
	Динамическое обновление ID при изменении спецификации
	Гибкое управление контентом: Опция скрытия поля "Производитель"
	Интеграция со списком резчиков: Быстрый выбор исполнителя из общего списка
	Двойная печать: Две идентичные этикетки на одном листе

**3. Общие стикеры
Универсальные инструменты для печати текстовых этикеток различных форматов:

**DoubleLabelPrinter (двойные этикетки)
	Параллельная печать: Две идентичные этикетки на одном листе
	Компактный формат: Размер по умолчанию 17×58 мм (узкие полоски)
	Автоматическое позиционирование: Точное расположение двух полосок
	Интеллектуальное форматирование: Автоматический перенос текста с учетом ширины этикетки

**SingleLabelPrinter (одиночные этикетки)
	Крупноформатные этикетки: Размер по умолчанию 70×100 мм
	Расширенный предпросмотр: До 14 строк текста с цветовой индикацией
	Режим объединения: Опция "Печатать вместе" для объединения всех строк файла в одну этикетку
	Профессиональное форматирование: Оптимальное для информационных ярлыков
	Гибкость работы: Возможность печатать каждую строку отдельно или объединять в одну этикетку

##⚙️ Технические особенности

**Общие возможности для всех модулей печати
	Предпросмотр в реальном времени: Визуализация текста перед печатью
	Гибкие источники данных: Ручной ввод, загрузка из файлов (.txt, .csv)
	Управление копиями: Настройка количества копий для каждой этикетки
	Контекстное меню: Копирование/вставка текста с поддержкой горячих клавиш
	Автоматическое сохранение настроек: Индивидуальные профили для каждого модуля

**Интеграция между компонентами
	Сквозная передача данных: Реестры автоматически передают данные в шаблоны этикеток
	Синхронизация настроек: Все модули используют единую систему конфигурации
	Общие списки: Резчики и упаковщики доступны во всех связанных модулях
	Согласованность интерфейса: Единый стиль управления для всех инструментов

**Система печати
	Раздельные настройки: Каждый модуль имеет собственный профиль печати
	Профессиональное форматирование: Точное позиционирование элементов на этикетках
	Поддержка различных форматов: От крупных информационных до компактных двойных этикеток
	Автоматическое обновление принтеров: Синхронизация со системными настройками

##🖨️ Особенности печати

**Для реестров и шаблонов
	Крупный шрифт: Чёткое отображение на этикетках большого формата
	Структурированное расположение: Логичное группирование информации
	Профессиональный вид: Соответствие промышленным стандартам маркировки

**Для диапазонов и спецификаций
	Компактный формат: Оптимальное использование пространства этикетки
	Динамический контент: Автоматическое формирование текста на основе введённых данных
	Адаптивность: Подстройка под требования конкретного заказчика

**Для общих стикеров
	Информационная насыщенность: Поддержка многострочного текста
	Читаемость: Крупный шрифт для легкого восприятия
	Универсальность: Подходит для различных типов маркировки

##🔄 Рабочие процессы

**Типичный сценарий работы:
	Подготовка данных → Ввод параметров заказа в соответствующем модуле
	Генерация реестра → Автоматический расчёт диапазонов номеров
	Визуальная проверка → Предпросмотр в таблицах и панелях предпросмотра
	Печать этикеток → Формирование шаблонов для роликов и коробок
	Контроль качества → Проверка соответствия требованиям заказчика

**Пакетная обработка:
	Массовая печать: Обработка крупных тиражей без ручного вмешательства
	Фоновая генерация: Неблокирующий интерфейс во время печати
	Контроль прогресса: Отслеживание статуса и возможность отмены операции
	Автоматическое ведение учёта: Сохранение истории диапазонов и настроек

##🔧 Управление данными

**Автоматическое сохранение
	Диапазоны номеров: Сохранение между сеансами работы
	Настройки печати: Индивидуальные профили для каждого модуля
	Списки исполнителей: Единая база резчиков и упаковщиков

**Валидация и обработка ошибок
	Проверка корректности: Контроль числовых значений и форматов
	Защита от переполнения: Ограничение максимального количества строк и символов
	Информативные сообщения: Чёткие указания по исправлению ошибок

**Гибкость конфигурации
	Настраиваемые параметры: Шрифты, отступы, размеры этикеток
	Адаптация под оборудование: Поддержка различных принтеров и DPI
	Масштабируемость: Возможность добавления новых форматов и шаблонов

Этот модуль представляет собой профессиональное решение для задач маркировки и
документирования в производственных условиях, ориентированное на специфические требования
особых заказчиков. Интеграция всех компонентов обеспечивает сквозной рабочий процесс от генерации данных
до финальной печати этикеток.

## 🛠️ Технические особенности проекта

- **Графический интерфейс**: Tkinter с современным оформлением
- **Модульная архитектура**: разделение на управляющее Ядро (core) и модули Приложений (apps)
- **Конфигурационные файлы**: JSON для сохранения гибких настроек в папке data
- **Система печати**: интеграция с Windows Print Spooler (win32print, win32ui)

## 📦 Установка и запуск

### Установка через установщик (рекомендуется)
	1. Скачайте установщик `CodeMax-CutMaster-Setup.exe`
	2. Запустите установщик от имени администратора
	3. Следуйте инструкциям мастера установки
	4. Ярлык программы появится на рабочем столе и в меню Пуск

### Поддерживаемые системы
	- ✅ Windows 10 (протестировано)
	- ✅ Windows 8/8.1 (протестировано)  
	- ✅ Windows 11 (совместимо)
	- ❌ Windows 7 и ниже не поддерживаются

### Системные требования
	- 0,8 ГБ свободного места на диске
	- 3 ГБ оперативной памяти
	- Разрешение экрана не менее 1250x860

## Зависимости (отсутствуют, если ставить установщик на Windows 8 и выше)
## Данные зависимости справедливы только при работе с исходным кодом:

Python 3.9+ (для Windows 7 python-3.8.6)

pywin32==306 - работа с Windows API (для Windows 7 pywin32==300)

openpyxl==3.1.2 - работа с Excel файлами (для Windows 7 openpyxl==3.0.9)

python-dotenv==1.0.1 - управление переменными окружения

## 🏗️ Структура проекта

CodeMax-CutMaster/
├── main.py                     # Главный запускаемый файл
├── core/                       # Общее ядро
│   ├── config_manager.py       # Управление настройками
│   └── shared_utils.py         # Общие утилиты
├── apps/                       # Приложения
│   ├── obc_app/                # Общий калькулятор
│   ├── dm_app/                 # Дата Матрикс обработка
│   └── syc_app/                # Особые заказчики
├── data/                       # Данные и настройки
│   ├── diapazon_ranges.json
│   ├── gtin_data.csv
│   ├── print_settings.json
│   ├── shared_utils.json
│   └── taper_settings.json
└── assets/                      # Ресурсы
    └── icons/
	
## 💻 Использование

## Основной интерфейс

**Программа открывается с тремя основными вкладками:
	Общий Калькулятор - основные расчёты резки
	Дата Матрикс Коды - работа с кодами
	Особые заказчики - специализированные функции

## Расчётные модули
	Ввод параметров заказа (метраж, длина этикетки, ручьи)
	Учёт прогресса работы
	Валидация параметров
	Экспорт результатов между вкладками

## Система печати
	Настройка принтеров
	Шаблоны этикеток
	Автоматическое обновление принтеров

## ⚙️ Конфигурация

## Основные настройки

**Хранятся в папке data/ в JSON-формате:
	shared_utils.json - общие настройки, резчики, заказчики
	print_settings.json - настройки печати для разных модулей
	taper_settings.json - параметры натяжения материалов

## Управление настройками

**Доступно через графический интерфейс:
	Редактирование списка резчиков, упаковщиков
	Настройка особых заказчиков и их требований
	Управление коэффициентами резки, множителем ручьёв
	Конфигурация принтеров

## 🔧 Разработка

**Добавление новых модулей
	Новые калькуляторы добавляются в папку apps/
	Общие утилиты размещаются в core/
	Настройки хранятся в JSON-файлах в папке data/

## 📄 Лицензия
Copyright © 2025 SolmirMech. Все права защищены.

## 💝 Благодарности
	Код разработан в тесном сотрудничестве с AI-ассистентом **DeepSeek.
	Человеческая часть: проектирование, частично рефакторинг, тестирование, руководство разработкой.
	AI-часть: генерация кода, частично рефакторинг, документация.
